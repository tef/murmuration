<!doctype html> 
<html> 
	<head> 
		<title>mumuration</title> 
		<meta charset="utf-8" /> 
	</head> 
	<body>
		<div align="center">
            <canvas id="c"></canvas>
		</div> 
		<script> 

function Flock(config) {
    this.size = config.size;
    this.dim = config.dim;
    this.positions = Array(config.size*config.dim);
    this.velocities = Array(config.size *config.dim);

    return this;
}

Flock.prototype.reset = function(radius) {
    for (var i=0; i<this.size; i++) {
        for (var j=0; j < this.dim; j++) {
            this.positions[i+j] = Math.random()*radius*2-radius;
            this.velocities[i+j] = Math.random()*2-1;
        }
    }
}

Flock.prototype.get_pos = function(bird) {
    return this.positions.slice(bird, bird+this.dim);
}

Flock.prototype.get_vel = function(bird) {
    return this.velocities.slice(bird, bird+this.dim);
}

Flock.prototype.set_pos = function(bird,p) {
    for (j=0; j<this.dim; j++) {
        this.positions[bird+j] = p[j];
    }
}

Flock.prototype.set_vel = function(bird,v) {
    for (j=0; j<this.dim; j++) {
        this.velocities[bird+j] = v[j];
    }
}

Flock.prototype.get_neighbours = function(bird) {
    var neighbours = []
    for (var n=0; n<this.size; n++) {
        neighbours.push(n)
    }
    return neighbours;
}

Flock.prototype.update_into = function(new_flock) {
    for (var n=0; n<this.size; n++) {
        var pos = this.get_pos(n);
        var vel = this.get_vel(n);
        for (var neighbour in this.get_neighbours(n)) {
            // cohesion
                // move towards centre of mass of neighbours
            // separation


            //alignment
        }
        for (var j=0; j<this.dim; j++) {
            pos[j]+=vel[j];
        }

        new_flock.set_pos(n, pos);
        new_flock.set_vel(n, vel);
    }
}
Flock.prototype.render = function(ctx, width, height,r) {
    for (var n=0; n<this.size; n++) {
        var p = this.get_pos(n);
        var x = p[0]+width/2;
        var y = p[1]+height/2;
        ctx.fillRect(x,y,r,r);
    }
}

var canvas=document.getElementById('c');
var ctx=canvas.getContext("2d");

window.onresize = function() {
    canvas.width = window.innerWidth*0.95;
    canvas.height = window.innerHeight*0.94;
}

window.onresize()

var config = {
    size: 10,
    dim: 2,
    bird_radius: 5,
}
var f1 = new Flock(config);
var f2 = new Flock(config);

f1.reset(config.size*5);

function paint() {
    var w=canvas.width,h=canvas.height;
    f1.update_into(f2)
    ctx.clearRect(0,0, w,h)
    ctx.fillStyle= 'black'
    f2.render(ctx,w,h, 3)
    f1=f2;
}


paint();

setInterval(paint,16)

		</script> 
	</body> 
</html>

